<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 2017\12\18 0018
 * Time: 10:07
 */

namespace app\user\home;

use think\Controller;
use app\user\model\home\Privilege;
use app\user\model\home\User;
use think\Db;
class ReleaseDetail extends Common
{

    private static $model ;
    public function _initialize()
    {
        parent::_initialize(); // TODO: Change the autogenerated stub
        self::$model = new Privilege;
    }

    public function index(){
       //判断用户是否有权限查看信息
        if(request()->isGet()){
            //进入详情页面的权限
            $data = self::$model->sel_privilege();
            $privew_data = array(
                'privilege_photo'=>$data->allow_priview_photo === 1 ? true : false,
                'privilege_video'=>$data->allow_priview_video === 1 ? true : false,
            );
            //传值查看权限
            $this->assign('privew_privilege',$privew_data);

            //伴游详情
            $uid = request()->param('id');
            $user_model = new User();
            $escort_base_info = $user_model->escort_base_info($uid);
            $this->assign('escort_base_info',$escort_base_info);

        }

       return $this->fetch();
    }


}